<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		*{
			padding: 0;margin: 0;
		}
		#main{
			position: relative;
		}
		.box{
			float: left;
			padding: 15px 15px 0 0;
		}
		.pic{
			padding: 5px;
			box-shadow: 0 0 5px black;
			border-radius: 5px;
		}
		img{
			width:230px;
		}
	</style>
	<script type="text/javascript">
		function getClass(obj,cla){
		var arr=[];
		var ocla=obj.getElementsByTagName('*');
		for(var i=0;i<ocla.length;i++){
			if(ocla[i].className==cla){
				arr.push(ocla[i])
			}
		}
		return arr;
	};
	function getIndex(arr,num){
		for(var i=0;i<arr.length;i++){
			if(arr[i]==num){
				return i
			}
		}
	}
		window.onresize=window.onload=function(){
			var omain=document.getElementById('main');
			var obox=getClass(omain,'box');
			var oboxW=obox[0].offsetWidth;
			var ow=document.documentElement.clientWidth||document.body.clientWidth;
			var cols=Math.floor(ow/oboxW);
			omain.style.width=(240+15)*cols+'px';
            omain.style.margin='0 auto';
			var oarr=[];
			var ojson={'data':[{'src':'images/0.jpg'},{'src':'images/1.jpg'},{'src':'images/2.jpg'},{'src':'images/3.jpg'},{'src':'images/4.jpg'},{'src':'images/5.jpg'},{'src':'images/6.jpg'}]}
			for(var j=0;j<obox.length;j++){
				var oboxh=obox[j].offsetHeight;
				if(j<cols){
					oarr.push(oboxh);
				}
				else{
					var min=Math.min.apply(null,oarr);
                    var index=getIndex(oarr,min);
                    obox[j].style.position='absolute';
                    obox[j].style.top=min+'px';
                    obox[j].style.left=obox[index].offsetLeft+'px';
                    oarr[index]+=obox[j].offsetHeight;
				}
			};
			window.onscroll=function(){
				var oh=obox[obox.length-1].offsetTop+Math.floor(obox[obox.length-1].offsetHeight/2);
				var oscroll=document.documentElement.scrollTop||document.body.scrollTop;
			    var oclient=document.documentElement.clientHeight||document.body.clientHeight;
			    //console.log(oscroll+oclient)
				if(oh<oscroll+oclient){
                  for(k=0;k<ojson.data.length;k++){
                  	var cdiv=document.createElement('div');
                  	omain.appendChild(cdiv);
                  	cdiv.className='box';
                  	var bcdiv=document.createElement('div');
                  	cdiv.appendChild(bcdiv);
                  	bcdiv.className='pic';
                  	var oimg=document.createElement('img');
                  	 bcdiv.appendChild(oimg);
                     oimg.src=ojson.data[k].src;
                  }
                  var oobox=getClass(omain,'box');
                  var ooarr=[];
                  for(var j=0;j<oobox.length;j++){
				var oboxh=oobox[j].offsetHeight;
				if(j<cols){
					ooarr.push(oboxh);
				}
				else{
					var min=Math.min.apply(null,ooarr);
                    var index=getIndex(ooarr,min);
                    oobox[j].style.position='absolute';
                    oobox[j].style.top=min+'px';
                    oobox[j].style.left=oobox[index].offsetLeft+'px';
                    ooarr[index]+=oobox[j].offsetHeight;
				}
			};
				}
			}
		}
	</script>
</head>
<body>
	<div id="main">
		<div class="box">
			<div class="pic"><img src="images/1.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/2.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/3.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/4.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/5.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/6.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/7.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/8.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/9.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/10.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/11.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/12.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/13.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/14.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/15.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/16.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/17.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/18.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/19.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/20.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/21.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/22.jpg" alt=""></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/23.jpg" alt=""></div>
		</div>
	</div>
</body>
</html>
